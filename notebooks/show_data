from matplotlib import pyplot as plt
from IPython import display


def show_frames(video_frames, first_frame, n=10):
    print(
        "{} total frames at {} fps".format(video_frames.frame_count, video_frames.fps)
    )
    frame = None
    for i, frame in enumerate(video_frames.frames):
        if i >= first_frame:
            plt.figure()
            plt.imshow(frame)
        if i >= first_frame + n:
            break
    video_frames.cleanup()
    if video_frames.frame_count:
        return frame


def generate_images(model, test_input, tar):
    prediction = model(test_input, training=True)
    plt.figure(figsize=(15, 15))

    display_list = [test_input[0], tar[0], prediction[0]]
    title = ["Input Image", "Ground Truth", "Predicted Image"]

    for i in range(3):
        plt.subplot(1, 3, i + 1)
        plt.title(title[i])
        # getting the pixel values between [0, 1] to plot it.
        plt.imshow(display_list[i] * 0.5 + 0.5)
        plt.axis("off")
    plt.show()


def show_images(test_ds, epoch):
    display.clear_output(wait=True)

    for example_input, example_target in test_ds.take(2):
        generate_images(pix2pix.generator, example_input, example_target)
    print("Epoch: ", epoch)
